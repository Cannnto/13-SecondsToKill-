var t=document.createElement("canvas"),s=t.getContext("2d");document.body.appendChild(t),t.width=1024,t.height=768,document.addEventListener("keydown",(function(t){i[t.keyCode]=!0})),document.addEventListener("keyup",(function(t){i[t.keyCode]=!1})),document.addEventListener("mousemove",(function(h){e.x=h.x-t.getBoundingClientRect().left,e.y=h.y-t.getBoundingClientRect().top})),document.addEventListener("mouseup",(function(t){0==t.button&&(Ut.atk=1);2==t.button&&Ut.fir()})),document.addEventListener("contextmenu",(t=>{t.preventDefault()}));var i=[],e={x:void 0,y:void 0},n=0;function r(t,h,i,e,n){s.fillStyle=n,s.fillRect(t,h,i,e)}function c(t,h,i,e){s.fillStyle=e,P(),s.arc(t,h,i,0,2*Math.PI),M()}function a(t,h,i,e,n,r){s.fillStyle=r,P(),s.ellipse(t,h,i,e,n,0,2*Math.PI),s.fill()}function o(t,h,s){return B((t.x+h/2-(Ut.x+Ut.w/2))**2+(t.y+s/2-(Ut.y+Ut.h/2))**2)*Gt<Jt}function d(){return F()*(F()<.5?1:-1)*Qt}function l(t,h,s){for(var i=0;i<h.length;i++)for(var e=0;e<h[i].length;e++)h[i][e].constructor.name==t&&s.push(h[i][e])}function u(t,h){for(var s=[],i=0;i<h.length;i++)h[i]&&(s[i]=h[i][t]);return s}function p(t,h,s){var i=t,e=i.indexOf(";"),n=i.slice(0,e),r=i.slice(e+1);Ht.sTX=n,Ht.aTX=r,Ht.clr=h,Ht.t=s,Ht.cTM=s}function f(t){67==t.keyCode&&(Ht.t=0),document.removeEventListener("keyup",f)}function b(){s.save()}function m(){s.restore()}function C(t,h){s.translate(t,h)}function g(t,h){s.scale(t,h)}function v(t){s.rotate(t)}function k(t){return Math.abs(t)}function P(){s.beginPath()}function M(){s.closePath(),s.fill()}function D(t,h,i){s.fillStyle=i,P(),s.moveTo(t,h)}function T(t,h){s.lineTo(t,h)}function F(){return Math.random()}function V(t){return Math.sin(t)}function I(t){return Math.cos(t)}function B(t){return Math.sqrt(t)}function A(t,h){s.shadowColor=h,s.shadowBlur=t}function $(t){for(let h=0;h<t.length;h++)t[h].upd(),t[h].die()&&t.splice(h,1)}class E{constructor(t,h){this.x=t.x+F()*t.w,this.y=t.y+F()*t.h,this.vx=2*F()-1,this.vy=4*F()-5,this.a=1,this.r=3,this.w=t.w,this.h=t.h,this.cor=h,this.e=t}die(){return this.a<0}upd(){this.x+=this.vx,this.y+=this.vy*(1-2*Qt),this.a-=.03,this.r>1&&(this.r-=.05+.05*F())}drw(){switch(this.cor){case"red":this.drw=function(){c(this.x,this.y,this.r,`rgba(${100+155*F()}, 10, 10, ${this.a})`)};break;case"ora":this.drw=function(){c(this.x,this.y,this.r,`rgba(${200+30*F()}, ${50+100*F()}, 10, ${this.a})`)};break;case"pur":this.y=this.e.y+this.e.h,this.drw=function(){c(this.x,this.y,this.r,`rgba(${60+200*F()}, ${115*F()}, 255, ${this.a})`)};break;case"bla":this.y=this.e.y+this.e.h,this.drw=function(){c(this.x,this.y,this.r,`rgba(${10*F()}, ${10*F()}, ${10*F()}, ${this.a})`)};break;case"blu":this.y=this.e.y+this.e.h,this.drw=function(){c(this.x,this.y,this.r,`rgba(10, ${50+100*Math.random()}, ${200+30*Math.random()}, ${this.a})`)}}}}class L{constructor(t){this.x=t.x+F()*t.w,this.y=t.y+F()*t.h,this.r=7.5*F(),this.c=`rgb(${100+155*F()}, 10, 10)`}drw(){c(this.x,this.y,this.r,this.c)}}var S="#3A4A13";function X(t){return x=t.x,y=t.y,w=t.w,h=t.h}function N(t){b(),C(t.x+t.w/2,t.y+t.h/2),v(t.cnt*Math.PI/180),C(-(t.x+t.w/2),-(t.y+t.h/2))}function _(t){b(),t.c&&(C(t.x+t.w/2,t.y+t.h/2),g(-1,1),C(-(t.x+t.w/2),-(t.y+t.h/2)))}function W(t,h){b(),C(t.x+t.w/2,t.y+t.h/2),v(h*Math.PI/180),C(-(t.x+t.w/2),-(t.y+t.h/2))}function R(t,h){b(),C(t.x+t.w/2,t.y+t.h/2),g(h,h),C(-(t.x+t.w/2),-(t.y+t.h/2))}function H(t){r(t.x+t.w/4,t.y-t.h/2,t.w/2,t.h/2,"white")}function K(t,h){r(t.x+.5*t.w/4,t.y+2.5*t.h/4,3*t.w/4,t.h/4,"#055769")}function Y(t,h){r(t.x+.5*t.w/4,t.y,3*t.w/4,1.25*t.h/2,h)}function q(t,h,s,i,e){r(t.x+t.w*h,t.y-t.h*s+i,t.w/8,1.3*t.h/8,e)}function O(t,s){X(t),H(t),r(x+2*w/8,y-4*h/8,4*w/8,.75*h/8+1,"#D9D9D9"),r(x+2*w/8,y-3.25*h/8,3*w/8,h/16+1),r(x+2*w/8,y-2.75*h/8,w/8,h/8+1),r(x+2.5*w/4,y-2.35*h/8,w/8,1.3*h/8,"black"),r(x+w/4,y-h/2,w/2*s,h/10*s,"red"),r(x+w/4,y-h/2,w/13*s,h/4*s,"red"),r(x+w/3.3,y-h/2,w/13*s,h/6*s,"red"),r(x+w/1.7,y-h/2,w/13*s,h/4*s,"red")}function j(t,s,i){X(t);let e={x:x+.75*w/4,y:y+3*h/4,w:1.25*w/4*2,h:-h/4*2};W(e,-5*s),r(e.x,e.y,e.w/2,-e.h/2,i),m()}function z(t,s,i){X(t),r(x+3*w/4+s,y,w/4,h/4,i)}function G(t,s,i,e,n){X(t);let c={x:x+2*w/4,y:y+.5*h/4-s,w:-w/4*2,h:-h/4*2};W(c,-10*s+e),r(c.x,c.y,-c.w/2,-c.h/2,i),r(c.x-c.w/2/10,c.y,-c.w/2/1.3*n,-c.h/2/4*n,"red"),r(c.x-c.w/2/4,c.y,-c.w/2/4*n,-c.h/2*n,"red"),m()}function J(t,s,i,e){X(t);let n={x:x+2*w/4,y:y+3*h/4,w:-1.25*w/4*2,h:-h/4*2};W(n,5*s),r(n.x,n.y,-n.w/2,-n.h/2,i),r(n.x-n.w/4,n.y,-n.w/2/2*e,-n.h/2/4*e,"red"),r(n.x-n.w/2.7,n.y,-n.w/2/4*e,-n.h/2/1.5*e,"red"),m()}function Q(t,s,i,e,n){X(t);var c={x:x+.3*w/4,y:y,w:3.4*w/4,h:h};Y(c,s),e&&(r(x+3*w/4-.5,y-.5+n,w/4+1,h/2+1,"black"),r(x+3*w/4,y+n,w/4,h/2,S),q(t,7/8,-1.35/8,n,"red")),e||r(x+3.25*w/4,y-.1*h/2,2,1.2*h/2,"#D9D9D9"),r(x+.75*w/4-.5,y-.1*h/2-.5,2.5*w/4+1,1.2*h/2+1,"black"),r(x+.75*w/4,y-.1*h/2,2.5*w/4,1.2*h/2,i),K(c)}function U(t,s){X(t),H(t),r(x+2*w/8,y-4*h/8,4*w/8,2.25*h/8,"#D9D9D9"),r(x+4*w/8-1,y-4*h/8-1,(2*w/8+2)*s,(4*h/8+2)*s,S),r(x+2*w/8,y-4*h/8,1*w/16*s,2*h/8*s,"red"),r(x+2*w/8,y-4*h/8,2*w/16*s,1*h/12*s,"red")}function Z(t,s,i,e){X(t),Y(t,s),r(x+.5*w/4-.5,y-.1*h/2-.5,3*w/4/2+1,1.2*h/2+1,"black"),r(x+.5*w/4,y-.1*h/2,3*w/4/2,1.2*h/2,i),r(x+.5*w/4-.5,y-.1*h/2-.5,(3*w/4+1)*e,(1.2*h/2+1)*e,"black"),r(x+.5*w/4,y-.1*h/2,3*w/4*e,1.2*h/2*e,i),K(t)}function tt(t){X(t),H(t),q(t,2.75/8,2.35/8,0,"black"),q(t,4.25/8,2.35/8,0,"black"),r(x+2*w/8,y-4*h/8,4*w/8,.75*h/8,"#D9D9D9"),r(x+5*w/8,y-3.25*h/8,w/8,h/16),r(x+2*w/8,y-3.25*h/8,w/8,h/16)}function ht(t,s){!function(t,s){X(t),r(x+w/4-.5,y-.5+s,w/2+1,h/2+1,"black"),r(x+2*w/8,y+s,3*w/8,h/2,S),r(x+5*w/8-1,y+h/8+s,w/8+1,1.5*h/4,S)}(t,s),q(t,2.75/8,-1.35/8,s,"red"),q(t,4.25/8,-1.35/8,s,"red")}function st(t,s){X(t);let i={w:w/4,h:1.2*h/2,y:.1*h/2};r(x+2.5*w/4-1,y-i.y-.5,i.w+1,i.h+1,"black"),r(x+2.5*w/4,y-i.y,i.w,i.h,s),r(x+2*w/3-2,y-i.y,2,i.h,"#D9D9D9")}function it(t,s,i,e,n,c){X(t),r(i+x,y+.5*h/4-s+e/4,w/4,h/4,n),r(i+x,y+.5*h/4-s+e/4,w/16*c,h/8*c,"red"),r(i+x+3*w/16,y+.5*h/4-s+e/4,w/16*c,h/4.5*c,"red")}function et(t,h,s,i){it(t,-h,0,0,s,0),it(t,h,3*t.w/4,0,s,i)}function nt(t,s,i,e,n,c){X(t);let a={x:x+.5*w/4,y:y+3*h/4,w:1.25*w/4,h:-h/4*2},o={x:x+2.25*w/4,y:a.y,w:a.w,h:a.h};R(a,s),r(a.x,a.y,a.w,-a.h/2,e),m(),R(o,i),r(o.x,o.y,o.w,-o.h/2,n),r(o.x,o.y,o.w/6*c,-o.h/3*c,"red"),r(o.x,o.y,o.w/1.5*c,-o.h/12*c,"red"),r(o.x,o.y,o.w/3*c,-o.h/6*c,"red"),m()}function rt(t,s,i,e,n){X(t);let c={x:x+2*w/4,y:y+.5*h/4,w:-w/4*2,h:-h/4*2};var a=0;t.a!=t.sid&&(a=e/4),t.a==t.sid&&W(c,-10*i+e),r(s-2.5,y+h/16-i+a,w/4+5,h/16,"black"),r(s+w/10,y+.5*h/4-i+a,w/16,h/4,"#552A18"),r(s+w/16,y+1.5*h/4-i+a,w/8,h/8,"#6F6F6F"),D(s+w/24,y-4*h/8+.5-i+a,n),T(s+w/8,y-6*h/8+.5-i+a),T(s+w/4.8,y-4*h/8+.5-i+a),M(),r(s+w/24,y-h/2-i+a,w/6,9*h/16,n);var o=-0*i*Math.PI/180;t.a==t.sid&&(m(),o=(-10*i+e)*Math.PI/180);let d={x:s+w/24,y:y-h/2-i+20*V(o),w:w/6,h:9*h/16},l={x:s+w/24-5.1*h/8,y:y-h/2-i+5*V(o),w:d.h,h:d.w};t.c&&(d.x-=15,l.x+=l.w+5);let u=d;180*o/Math.PI<-45&&(u=l)}function ct(t){X(t),s.fillStyle="red",W(t,180*n/Math.PI),P(),D(x,y),T(x+w/2,y+h/6),T(x+w,y+h/2),T(x+w/2,y+h/1.2),T(x,y+h),T(x+w/3,y+h/1.3),T(x+w/2,y+h/2),T(x+w/3,y+h/4),M(),m(),s.fill()}function wt(t){X(t);let s={x:x+w/2-w/16,y:y+w/3-6,w:w/8,h:h},i={x:x+w/2-w/16,y:y-7.5,w:w/16,h:h/1.2},e="#E29628",n="#B5701D";r(x,y,w,h,"#995F12"),W(s,-60),r(s.x,s.y,s.w,s.h,n),m(),W(i,82),r(i.x,i.y,i.w,i.h,n),m(),r(x+1,y+1,w/8-2,h-2,e),r(x+1,y+1,w-2,h/12-2,e),r(x+1,y+h/4+1,w-2,h/8-2,e),r(x+1+.875*w,y+1,w/8-2,h-2,e),r(x+1,y+.875*h+1,w-2,h/8-2,e)}function xt(t,s){X(t),a(x+w/2,y+h/2,w/3,h/8,0,s),a(x+w/2,y+h/1.2,w/2.5,h/5,0,"gray"),a(x+w/2,y+h/1.2,w/3,h/8,0,s),r(x+w/6,y+h/2,w/1.5,h/4,s)}function at(t){X(t),s.font=w/2+"px Arial",s.textAlign="center",s.fillStyle="white",s.fillText("[E]",x+w/2,y-h)}function ot(t,h){r(t,h,1,10.6),r(t+8,h,1,10.6),r(t+16,h,1,10.6),r(t+24,h,1,10.6)}function yt(t){X(t),r(x,y,32,32,"#20252E"),r(x,y,1,32,"#6D798B"),r(x+31,y,1,32)}function dt(t,h,s){if(X(t),_t[Ot].map.arr[y/32+s]&&_t[Ot].map.arr[y/32+s][x/32+1*h])return"Wal"==_t[Ot].map.arr[y/32+s][x/32+1*h].constructor.name}class lt{constructor(t,h){this.x=t,this.y=h}sum(t){this.x+=t.x,this.y+=t.y}div(t){this.x/=t,this.y/=t}mtp(t){this.x*=t,this.y*=t}lim(t){this.x=Math.min(Math.max(this.x,-t),t),this.y=Math.min(Math.max(this.y,-t),t)}}class ut{constructor(t,h,s,i){this.x=t,this.y=h,this.w=s/2,this.h=i/2,this.d=new lt(0,0),this.spd=new lt(0,0),this.c=0,this.cnt=1,this.rot=0,this.par=[],this.fri=0,this.acel=0}drw(){this.d.x&&(this.a=this.sid,this.c=0,this.d.x<0&&(this.c=1)),this.d.y>0&&k(this.d.y)>k(this.d.x)&&(this.a=this.fro,this.c=0),this.d.y<0&&k(this.d.y)>k(this.d.x)&&(this.a=this.bac,this.c=0),this.spd.x||this.spd.y?(this.cnt++,this.rot&&(this.cnt-=2),(this.cnt>=3||this.cnt<=-3)&&(this.rot=!this.rot)):this.cnt>0?this.cnt-=.25:this.cnt<0&&(this.cnt+=.25),this.a(),this.lfB()}lfB(){}a(){this.fro()}cld(t){for(let h=0;h<t.length;h++)if(this.x+this.w>=t[h].x&&this.x<=t[h].x+t[h].w&&this.y+this.h>=t[h].y&&this.y<=t[h].y+t[h].h)return!0}u(t){return _t[Ot].map.arr[t.l][t.c].col||"dor"==_t[Ot].map.arr[t.l][t.c].constructor.name&&!jt}CWL(){return this.mp1={c:parseInt(this.x/32),l:parseInt(this.y/32)},this.mp2={c:parseInt((this.x+this.w)/32),l:parseInt(this.y/32)},this.mp3={c:parseInt((this.x+this.w)/32),l:parseInt((this.y+this.h)/32)},this.mp4={c:parseInt(this.x/32),l:parseInt((this.y+this.h)/32)},this.u(this.mp1)||this.u(this.mp2)||this.u(this.mp3)||this.u(this.mp4)}}class pt extends ut{constructor(t,h,s,i,e){super(t,h,s,i),this.a=e}drw(){r(this.x,this.y,this.w,this.h,"red");for(let t=0;t<5;t++)Yt.push(new E(this,"ora"))}die(){if(this.CWL())return!0;for(var t=0;t<_t[Ot].boxes.length;t++)if(this.cld([_t[Ot].boxes[t].box]))return!0;for(t=0;t<Kt.length;t++)if(Kt[t].cld([this]))return Kt[t].lif.c-=100,!0}upd(){this.x+=5*I(this.a),this.y+=5*V(this.a);let t=parseInt((this.x+this.w/2)/32),h=parseInt((this.y+this.h/2)/32);"Ice"==_t[Ot].map.arr[h][t].constructor.name&&(_t[Ot].map.arr[h][t]=new Dt(32*t,32*h))}}class ft extends ut{constructor(t,h){super(t,h,64,64),this.spX=t,this.spY=h}psh(t){this.spd.x=t.spd.x,this.spd.y=t.spd.y}drw(){wt(this)}upd(){this.x+=this.spd.x,this.y+=this.spd.y,this.CWL()&&(this.x-=this.spd.x,this.y-=this.spd.y,this.spd.x=0,this.spd.y=0),0!=this.spd.x&&(this.spd.x+=this.fri*Math.sign(this.spd.x)*-1),0!=this.spd.y&&(this.spd.y+=this.fri*Math.sign(this.spd.y)*-1),this.spd.x=Number(this.spd.x.toFixed(2)),this.spd.y=Number(this.spd.y.toFixed(2))}}class bt extends ut{constructor(t,h,s,i){super(t,h,s,i),this.anC=0,this.gra=0,this.spe=1,this.spV=new lt(0,0),this.acV=new lt(0,0),this.r=50,this.raE=50,this.raP=1e3,this.rPM=1e3,this.wH=1,this.wHa=1}die(){return this.dea}wlk(t,h){this.x+=t,this.y+=h}upd(){let t=new lt(0,0),h=new lt(0,0),s=0;for(let i of Kt){let e=B((this.x+this.w/2-(i.x+i.w/2))**2+(this.y+this.h/2-(i.y+i.h/2))**2);if(B((this.x+this.w/2-(Ut.x+Ut.w/2))**2+(this.y+this.h/2-(Ut.y+Ut.h/2))**2)<=this.raP?(h=new lt(Ut.x+Ut.w/2-(this.x+this.w/2),Ut.y+Ut.h/2-(this.y+this.h/2)),this.raP=this.rPM):this.raP>150&&(this.raP-=.2),this!=i&&e<=this.raP&&(i.raP>this.raP||this.raP>i.raP)&&(i.raP=this.raP),this!=i&&e<=this.raE){let h=new lt(this.x+this.w/2-(i.x+i.w/2),this.y+this.h/2-(i.y+this.h/2));s++,t.sum(h)}s&&t.div(s);let n=B(t.x**2+t.y**2);n&&t.div(n),t.mtp(2*this.spe);let r=B(h.x**2+h.y**2);r&&h.div(r),h.mtp(.8*this.spe),this.acV.sum(t),this.acV.sum(h),this.spV.sum(this.acV),this.spV.lim(this.spe),this.anC&&(this.spV.mtp(0),h.mtp(0)),this.d=h,this.spd=h}this.wlk(this.spV.x,this.spV.y),this.CWL()&&this.wlk(-this.spV.x,-this.spV.y);for(var i=0;i<_t[Ot].boxes.length;i++)this.cld([_t[Ot].boxes[i].box])&&(_t[Ot].boxes[i].box.psh(this,this.d.x,this.d.y),this.wlk(-this.spV.x,-this.spV.y));this.acV.mtp(0),this.spV.x&&(this.spV.x+=this.fri*Math.sign(this.spV.x)*-1),this.spV.y&&(this.spV.y+=this.fri*Math.sign(this.spV.y)*-1),this.spV.x=Number(this.spV.x.toFixed(2)),this.spV.y=Number(this.spV.y.toFixed(2))}}class mt extends bt{constructor(t,h,s,i){super(t,h,s,i),this.lif={m:100,c:100},this.rec=60}sid(){_(this),j(this,this.cnt,S),N(this),Q(this,"#5C0C0C","#5C0C0C",1,this.anC),m(),G(this,this.cnt,S,0,0),J(this,this.cnt,S,0),m()}bac(){et(this,this.cnt,S,0),nt(this,this.cnt<0?.8:this.cnt?1.2:1,this.cnt>0?.8:this.cnt?1.2:1,S,S,0),N(this),Z(this,"#5C0C0C","#5C0C0C",1),m()}fro(){N(this),Z(this,"#5C0C0C","#5C0C0C",1),ht(this,this.anC),m(),et(this,this.cnt,S,0),nt(this,this.cnt<0?.8:this.cnt?1.2:1,this.cnt>0?.8:this.cnt?1.2:1,S,S,0)}lfB(){if(this.y-.5+this.h/2+1+this.anC>this.y+this.h&&(this.dea=1,Ut.tim.c+=this.rec),this.lif.c<=0){this.gra+=.25,this.anC+=this.gra;for(let t=0;t<5;t++)Yt.push(new E(this,"red"));qt.push(new L(this))}else r(this.x,this.y-this.h/4,this.w,this.h/8,"white"),r(this.x,this.y-this.h/4,this.w*this.lif.c/this.lif.m,this.h/8,"red")}}function Ct(t){return Array.from({length:24},(h=>Array.from({length:32},(h=>t))))}function gt(h){for(var s=0;s<t.height/32;s++)h[s][0]=h[s][31]=2;for(var i=1;i<t.width/32-1;i++)h[0][i]=h[23][i]=2}class vt{constructor(t){this.map=t,function(t){for(var h=0;h<t.length;h++)for(var s=0;s<t[h].length;s++)switch(Number(t[h][s])){case 1:t[h][s]=new Dt(32*s,32*h);break;case 2:t[h][s]=new Mt(32*s,32*h);break;case 3:t[h][s]=new Tt(32*s,32*h);break;case 4:t[h][s]=new Ft(32*s,32*h);break;case 5:t[h][s]=new Bt(32*s,32*h);break;case 6:t[h][s]=new Vt(32*s,32*h);break;case 7:t[h][s]=new At(32*s,32*h);break;case 8:t[h][s]=new $t(32*s,32*h);break;case 9:t[h][s]=new Lt(32*s,32*h);break;case 10:t[h][s]=new St(32*s,32*h);break;case 11:t[h][s]=new Xt(32*s,32*h);break;case 12:t[h][s]=new Et(32*s,32*h);break;case 13:t[h][s]=new It(32*s,32*h,F()>.5)}}(this.map.arr),this.boxes=[],this.btns=[],this.boxT=[],this.swi=[],l("Swi",this.map.arr,this.swi),l("Bxs",this.map.arr,this.boxes),l("Btn",this.map.arr,this.btns),l("BDT",this.map.arr,this.boxT),function(t){let h=t.length;for(;h;){let s=Math.floor(Math.random()*h);h--,[t[h],t[s]]=[t[s],t[h]]}}(this.btns),this.swi.sort(((t,h)=>t.x-h.x))}drw(){this.map.drw();for(let t=0;t<this.boxes.length;t++)o(this.boxes[t].box,32,32)&&this.boxes[t].box.drw();for(let t=0;t<this.boxT.length;t++)this.boxT[t].act&&0;for(var t="",h=0;h<this.swi.length;h++)t+=this.swi[h].tx;".____...__"==t&&(jt=!0)}}class kt{constructor(t){this.arr=t}drw(){for(var t=0;t<this.arr.length;t++)for(var h=0;h<this.arr[t].length;h++)this.arr[t][h]&&o(this.arr[t][h],32,32)&&this.arr[t][h].drw(),this.arr[t][h]&&this.arr[t][h].upd()}}class Pt{constructor(t,h){this.x=t,this.y=h,this.w=this.h=32}drw(){s.fillStyle=this.clr,s.fillRect(this.x,this.y,32,32)}upd(){}collide(t){return this.x+32>=t.x&&this.x<=t.x+t.w&&this.y+32>=t.y&&this.y<=t.y+t.h}}class Mt extends Pt{constructor(t,h){super(t,h),this.col=!0}drw(){dt(this,1,0)&&dt(this,-1,0)?this.drw=function(){Wt(this),X(this),r(x,y+h-1,w,1,"black"),r(x,y,w,1),ot(x,y),r(x,y+1*h/3,h,1),ot(x+1*w/8,y+1*h/3),r(x,y+2*h/3,h,1),ot(x+1*w/32,y+2*h/3)}:dt(this,0,-1)&&dt(this,0,1)?this.drw=function(){yt(this)}:(dt(this,0,-1)||dt(this,0,1)||(this.drw=function(){yt(this),r(this.x,this.y+this.h-1,this.w,1,"#6D798B"),r(this.x,this.y,this.w,1,"#6D798B")}),dt(this,0,-1)&&(this.drw=function(){yt(this),r(this.x,this.y+this.h-1,this.w,1,"#6D798B")}),dt(this,0,1)&&(this.drw=function(){yt(this),r(this.x,this.y,this.w,1,"#6D798B")}))}}class Dt extends Pt{constructor(t,h){super(t,h)}drw(){Wt(this)}upd(){for(var t=0;t<th.length;t++)this.collide(th[t])&&(th[t].fri=1,th[t].acel=5)}}class Tt extends Pt{constructor(t,h){super(t,h),this.clr="#6b5421"}upd(){this.collide(Ut)&&jt&&(Ot++,Ut.x=Rt[Ot].spwPoint.x,Ut.y=Rt[Ot].spwPoint.y,Kt=[],qt=[],Yt=[],Ut.bal=[],jt=!1)}}class Ft extends Pt{constructor(t,h,s){super(t,h),this.enA=0,this.spT=90,this.cuT=0}arT(){this.cuT==this.spT&&(Kt.push(new mt(this.x,this.y,64,64,this)),this.enA++,this.cuT=0),this.cuT++}drw(){Wt(this),X(this),r(x+w/8,y+h/8,.75*w,.75*h,"#C6C6C8"),r(x+w/8,y+h/8,.75*w/8,.75*h,"red"),r(x+w/8,y+h/8,.75*w/4,.75*h/2.5,"red"),r(x+.05*w,y+h/1.5,.9*w,h/4,"#D9D9D9")}upd(){this.enA<30&&this.arT()}}class Vt extends Pt{constructor(t,h){super(t,h),this.clr="red",this.cld=!1}upd(){if(this.collide(Ut)){if(_t[Ot].btns[zt]!=this||this.cld){if(!this.cld){for(var t=0;t<_t[Ot].btns.length;t++)_t[Ot].btns[t].clr="red";zt=0}}else this.clr="green",zt++;this.cld=!0,4==zt&&(jt=!0)}else this.cld=!1}drw(){Wt(this),xt(this,this.clr)}}class It extends Pt{constructor(t,h,s){super(t,h),this.clr="red",this.cld=!1,this.cp=s,this.tx="."}drw(){var t;Wt(this),xt(this,this.clr),X(t=this),r(x+w/2-w/1.5/2,y-h/3,w/1.5,h/2,"black"),s.font=`${w}px arial`,s.textAlign="center",s.textBaseline="middle",s.fillStyle="white",t.cp?s.fillText(t.tx,x+w/2,y-h/1.75/2):s.fillText(t.tx,x+w/2,y-h/2)}upd(){B((this.x+this.w/2-(Ut.x+Ut.w/2))**2+(this.y+this.h/2-(Ut.y+Ut.h/2))**2)<50&&(Ut.int=!0,i[69]&&(this.cp=!this.cp,i[69]=!i[69])),this.tx="_",this.cp&&(this.tx=".")}}class Bt extends Pt{constructor(t,h){super(t,h),this.clr="#FF9633",this.box=new ft(this.x,this.y)}}class At extends Pt{constructor(t,h){super(t,h),this.act=!1,this.clr="purple"}bCD(){for(var t=_t[Ot].boxes.length,h=0;h<t;h++)if(this.x+32>=_t[Ot].boxes[h].box.x&&this.x<=_t[Ot].boxes[h].box.x+_t[Ot].boxes[h].box.w&&this.y+32>=_t[Ot].boxes[h].box.y&&this.y<=_t[Ot].boxes[h].box.y+_t[Ot].boxes[h].box.h)return!0;return!1}upd(){this.act=this.bCD(),this.bCD()?this.clr="green":this.clr="purple"}}class $t extends Pt{constructor(t,h,s){super(t,h),this.clr="#7C653C",this.col=!0,this.txt=s}drw(){Wt(this),X(this),r(x,y,w,h/1.75,"#7C653C"),r(x+w/2.2,y,w/8,h,"#7C653C"),r(x+.1*w,y+h/1.75*.5/4,.8*w,h/3/4,"#574220"),r(x+.1*w,y+h/1.75*1.75/4,.8*w,h/3/4,"#574220"),r(x+.1*w,y+h/1.75*3/4,.8*w,h/3/4,"#574220")}upd(){B((this.x+this.w/2-(Ut.x+Ut.w/2))**2+(this.y+this.h/2-(Ut.y+Ut.h/2))**2)<50&&(i[69]&&p(this.txt,"black",100),Ut.int=1)}}class Et extends Pt{constructor(t,h){super(t,h),this.clr="lightblue"}upd(){for(var t=0;t<th.length;t++)this.collide(th[t])&&(th[t].fri=.02,th[t].acel=.1)}}class Lt extends Pt{constructor(t,h){super(t,h),this.col=!0,this.bx1={x:this.x,y:this.y,w:this.w,h:this.h},this.bx2={x:this.x,y:this.y-this.h/1.4,w:this.w,h:this.h}}drw(){wt(this.bx1),wt(this.bx2)}}class St extends Pt{constructor(t,h){super(t,h),this.col=!0}drw(){wt(this)}}class Xt extends Pt{constructor(t,h){super(t,h),this.r=90*parseInt(4*F())}drw(){var t,s;Wt(this),A(3,"black"),t=this,s=this.r,X(t),W(t,s),r(x+.4*w/3,y+1.6*h/3,w/5,h/5,"#4C4C4C"),r(x+1.7*w/3,y+2*h/3,w/3,h/4,"#4C4C4C"),r(x+.2*w/3,y+.2*h/3,w/3,h/3,"#333333"),r(x+2*w/3,y+.5*h/3,w/4,h/5,"#333333"),m(),A(0)}}var Nt,_t=[new vt(new kt(function(t){gt(t),t[0][16]=t[0][15]=3,t[1][1]=t[22][30]=4,t[12][28]=8;let h=0;for(;h<10;){let s=parseInt(22*F()),i=parseInt(30*F());1==t[s][i]&&(t[s][i]=11,h++)}return t[2][23]=t[2][24]=t[1][24]=t[1][25]=9,t[2][25]=t[1][22]=t[1][23]=t[1][26]=10,t[5][5]=new $t(160,160,"1: .----;3: ...--;"),t[10][10]=t[10][11]=t[10][12]=t[10][13]=t[10][14]=t[10][17]=t[10][18]=t[10][19]=t[10][20]=t[10][21]=13,t}(Ct(1)))),new vt(new kt((Nt=Ct(1),function(t){gt(t);for(var h=0;h<23;h++)t[11][h]=2;for(var s=12;s<24;s++)t[s][22]=2;for(h=0;h<22;h++)for(s=12;s<24;s++)t[s][h]=0}(Nt),Nt[0][16]=Nt[0][15]=3,Nt[1][1]=Nt[22][30]=4,Nt[9][9]=Nt[9][15]=5,Nt))),new vt(new kt(function(t){return function(t){gt(t);for(var h=1;h<16;h++)for(var s=0;s<13;s++)t[h+8][s+19]=t[h+8][s]=0;for(s=0;s<13;s++)t[9][s+19]=t[9][s]=2;for(h=10;h<24;h++)t[h][12]=t[h][19]=2}(t),t[0][16]=t[0][15]=3,t[4][5]=t[6][5]=t[4][7]=t[6][7]=6,t}(Ct(1)))),new vt(new kt(function(t){return function(t){gt(t);for(var h=0;h<8;h++)for(var s=11;s<21;s++)t[h][s]=t[h+16][s]=0;for(s=11;s<21;s++)t[16][s]=t[7][s]=2;for(h=0;h<7;h++)t[h][11]=t[h][20]=t[h+17][11]=t[h+17][20]=2}(t),t[0][6]=t[0][5]=3,t[1][1]=t[22][30]=4,t[9][9]=t[9][15]=5,t}(Ct(12)))),new vt(new kt(function(t){return function(t){gt(t);for(var h=7;h<17;h++)for(var s=10;s<32;s++)t[h][s]=0;for(s=10;s<32;s++)t[16][s]=t[7][s]=2;for(h=8;h<16;h++)t[h][10]=2}(t),t[0][26]=t[0][25]=3,t}(Ct(1))))];function Wt(t){r(t.x,t.y,32,32,"#24282E")}var Rt=[{backPoint:{x:512,y:32}},{spwPoint:{x:845,y:672},backPoint:{x:520,y:32}},{spwPoint:{x:499.2,y:672},backPoint:{x:520,y:32}},{spwPoint:{x:819,y:672},backPoint:{x:260,y:32}},{spwPoint:{x:845,y:672},backPoint:{x:520,y:32}}],Ht={t:0,sTX:"",aTX:"",clr:"",cTM:0},Kt=[new class extends bt{constructor(t,h,s,i){super(t,h,s,i),this.lif={m:200,c:200},this.spd.x=0,this.rec=90}sid(){_(this),j(this,this.cnt,S),z(this,this.cnt,S),N(this),O(this,1),Q(this,"#5C0C0C","#B40F0F",0,this.anC),m(),G(this,this.cnt,"white",0,1),J(this,this.cnt,"white",1),m()}bac(){it(this,this.cnt,3*this.w/4,0,S,0),it(this,-this.cnt,0,0,"white",1),nt(this,this.cnt<0?.8:this.cnt?1.2:1,this.cnt>0?.8:this.cnt?1.2:1,"white",S,0),N(this),U(this,1),Z(this,"#5C0C0C","#B40F0F",0),m()}fro(){var t;N(this),Z(this,"#5C0C0C","#5C0C0C",1),tt(this,this.anC),t=this,this.anC,X(t),r(x+w/4-1,y-h/2-1,w/4+2,h/2+2,S),r(x+2.4*w/8,y-2.9*h/8,w/6,1.5*h/8,"red"),r(x+3*w/4-w/16,y-h/2,w/16,h/4,"red"),r(x+3*w/4-w/8,y-h/2,w/8,h/16,"red"),st(this,"#B40F0F"),m(),it(this,this.cnt,3*this.w/4,0,"white",1),it(this,-this.cnt,0,0,S,0),nt(this,this.cnt<0?.8:this.cnt?1.2:1,this.cnt>0?.8:this.cnt?1.2:1,S,"white",1)}lfB(){if(this.y-.5+this.h/2+1+this.anC>this.y+this.h&&(this.dea=1,Ut.tim.c+=this.rec),this.lif.c<=0){this.gra+=.25,this.anC+=this.gra;for(let t=0;t<5;t++)Yt.push(new E(this,"red"));qt.push(new L(this))}else r(this.x,this.y-this.h/1.25,this.w,this.h/8,"white"),r(this.x,this.y-this.h/1.25,this.w*this.lif.c/this.lif.m,this.h/8,"red")}}(100,t.height/2,64,64)],Yt=[],qt=[],Ot=0,jt=!0,zt=0,Gt=0,Jt=200,Qt=0,Ut=(setInterval((function(){r(0,0,t.width,t.height,"black"),th=Kt.concat(Ut,u("box",_t[Ot].boxes)),_t[Ot].drw();for(var h=0;h<u("box",_t[Ot].boxes).length;h++)u("box",_t[Ot].boxes)[h].upd();for(let t=0;t<qt.length;t++)o(qt[t],0,0)&&qt[t].drw();(Zt=Kt.concat(Ut,Ut.bal)).sort(((t,h)=>t.y-h.y));for(let t=0;t<Zt.length;t++)o(Zt[t],Zt[t].w,Zt[t].h)&&Zt[t].drw();for(let t=0;t<Yt.length;t++)o(Yt[t],0,0)&&Yt[t].drw();$(Ut.bal),$(Kt),$(Yt),Ut.upd(),n=Math.atan2(e.y-(Ut.y+Ut.h/2),e.x-(Ut.x+Ut.w/2))+Math.PI*Qt,Ut.d.x=I(n),Ut.d.y=V(n),C(d(),d()),i[87-4*Qt]&&Ut.spd.y>-Ut.msp&&(Ut.spd.y-=Ut.acel);Ut.spd.y<-Ut.msp&&(Ut.spd.y=-Ut.msp);i[83+4*Qt]&&Ut.spd.y<Ut.msp&&(Ut.spd.y+=Ut.acel);Ut.spd.y>Ut.msp&&(Ut.spd.y=Ut.msp);i[65+3*Qt]&&Ut.spd.x>-Ut.msp&&(Ut.spd.x-=Ut.acel);Ut.spd.x<-Ut.msp&&(Ut.spd.x=-Ut.msp);i[68-3*Qt]&&Ut.spd.x<Ut.msp&&(Ut.spd.x+=Ut.acel);Ut.spd.x>Ut.msp&&(Ut.spd.x=Ut.msp);Ht.t?(function(h,i){r(0,t.height-100,t.width,100,"rgba(255,255,255,0.5)"),r(10,t.height-90,t.width-20,80,"rgba(0,0,0,0.5)"),s.fillStyle=i,s.font="20px Arial",s.textAlign="center",s.fillText(h,t.width/2,t.height-45)}(Ht.sTX,Ht.clr,Ht.t),Ht.t--,document.addEventListener("keyup",f)):""!=Ht.aTX&&p(Ht.aTX,Ht.clr,Ht.cTM),r(0,0,t.width*Qt,t.height*Qt,"rgba(75,0,130,0.4)"),hh.drw(),Ut.tim.c&&Ut.tim.c--}),1e3/30),new class extends ut{constructor(t,h,s,i){super(t,h,s,i),this.atC=0,this.bal=[],this.msp=5,this.int=0,this.tim={c:390,m:390},this.amo={c:0,m:60}}sid(){_(this),z(this,this.cnt,"white"),j(this,this.cnt,"white"),N(this),O(this),Q(this,"#6F6F6F","#424242",0),m(),rt(this,this.x+2*this.w/4,this.cnt,this.atC,"red"),G(this,this.cnt,"white",this.atC,0),J(this,this.cnt,"white",0),m()}bac(){rt(this,this.x,-this.cnt,this.atC,"red"),it(this,-this.cnt,0,this.atC,"white",0),it(this,this.cnt,3*this.w/4,0,"white",0),nt(this,this.cnt<0?.8:this.cnt?1.2:1,this.cnt>0?.8:this.cnt?1.2:1,"white","white",0),N(this),U(this,"#424242"),Z(this,"#6F6F6F","#424242",1),m()}fro(){N(this),tt(this),function(t){X(t),Y(t,"#6F6F6F");let s={w:w/4,h:1.2*h/2,y:.1*h/2};r(x+.5*w/4,y-s.y-.5,s.w+1,s.h+1,"black"),r(x+.5*w/4,y-s.y,s.w,s.h,"#424242"),r(x+w/3,y-s.y,2,s.h,"#D9D9D9"),st(t,"#424242"),K(t)}(this),m(),it(this,this.cnt,3*this.w/4,this.atC,"white",0),it(this,-this.cnt,0*this.w/4,0,"white",0),rt(this,this.x+3*this.w/4,this.cnt,this.atC,"red"),nt(this,this.cnt<0?.8:this.cnt?1.2:1,this.cnt>0?.8:this.cnt?1.2:1,"white","white",0)}ATK(){var t={x:this.x+40*this.d.x,y:this.y+60*this.d.y-this.h/2,w:this.h,h:1.5*this.w};ct(t);for(var h=0;h<_t[Ot].boxes.length;h++)_t[Ot].boxes[h].box.cld([t])&&(_t[Ot].boxes[h].box.x=_t[Ot].boxes[h].box.spX,_t[Ot].boxes[h].box.y=_t[Ot].boxes[h].box.spY);for(h=0;h<Kt.length;h++)Kt[h].cld([t])&&(Kt[h].lif.c-=50)}fir(){this.amo.c||(this.bal.push(new pt(this.x+this.w/2,this.y+this.h/2,16,16,n)),this.amo.c++)}move(t){this.x+=this.spd.x*k(this.spd.x/this.len)*t,this.y+=this.spd.y*k(this.spd.y/this.len)*t}upd(){this.amo.c&&this.amo.c++,this.amo.c==this.amo.m&&(this.amo.c=0),this.atA&&(this.atC+=20,this.atk=0,this.atC||(this.ATK(),this.atA=0)),this.atk&&(this.atC-=10,this.atC<-90&&(this.atA=1)),this.int&&at(this),this.int=0,this.len=this.spd.x||this.spd.y?B(this.spd.x**2+this.spd.y**2):1,this.move(1),this.CWL()&&(this.move(-1),this.spd.mtp(0));for(var t=0;t<_t[Ot].boxes.length;t++)this.cld([_t[Ot].boxes[t].box])&&(_t[Ot].boxes[t].box.psh(this,this.d.x,this.d.y),this.move(-1));this.spd.x&&(this.spd.x+=this.fri*Math.sign(this.spd.x)*-1),this.spd.y&&(this.spd.y+=this.fri*Math.sign(this.spd.y)*-1),this.spd.x=Number(this.spd.x.toFixed(2)),this.spd.y=Number(this.spd.y.toFixed(2)),this.tim.c>this.tim.m&&(this.tim.c=this.tim.m)}}(t.width/2,t.height/2,64,64)),Zt=[],th=[],hh=new class{constructor(){}drw(){A(5,"black"),D(104,48,"white"),T(159,48),T(169,48),T(159,64),T(104,64),M();let t=Ut.amo.c/Ut.amo.m;t||(t=1),D(104,48,"orange"),T(104+55*t,48),T(104+65*t,48),T(104+55*t,64),T(104,64),M(),D(104,32,"white"),T(214,32),T(224,40),T(214,48),T(104,48),M(),D(104,32,"red"),T(104+110*Ut.tim.c/Ut.tim.m,32),T(104+120*Ut.tim.c/Ut.tim.m,40),T(104+110*Ut.tim.c/Ut.tim.m,48),T(104,48),M(),A(0),tt({x:8,y:80,w:128,h:128})}};